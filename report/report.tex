\documentclass[14pt, openany, titlepage]{report} % Explicitly use openany and titlepage
\usepackage[utf8]{inputenc}
\usepackage[italian,english]{babel}
\usepackage{graphicx}
\usepackage{cite}
\usepackage{amsmath}
\usepackage[table,xcdraw]{xcolor}
\usepackage[italian]{minitoc}
\usepackage{fancybox}
\usepackage{fancyhdr}
\usepackage{verbatim}
\usepackage{url}
\usepackage{color}
\usepackage{listings}
\usepackage{makeidx}
\usepackage{comment}
\usepackage{hyperref}
\usepackage{bm}
\usepackage{longtable}
\usepackage{tabularx}
\usepackage{placeins}
\usepackage{caption}
\usepackage{float}
\usepackage{xcolor}
\usepackage{soul}
\usepackage{array}
\usepackage{multirow}
\usepackage{adjustbox} % Pacchetto per ridimensionare automaticamente
\usepackage{graphicx} % Per il ridimensionamento
\usepackage{lscape}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{listings}
\usepackage[svgnames]{xcolor}
\usepackage{booktabs}

% Set link colors without borders
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=cyan,
}

\lstset{frame=tb,
    language=Java,
    numbers=left,
    keywordstyle=\color{blue},
    alsoletter={.}
}

\lstset{language=R,
    basicstyle=\small\ttfamily,
    stringstyle=\color{DarkGreen},
    otherkeywords={0,1,2,3,4,5,6,7,8,9},
    morekeywords={TRUE,FALSE},
    deletekeywords={data,frame,length,as,character},
    keywordstyle=\color{blue},
    commentstyle=\color{DarkGreen},
}

\graphicspath{ {./Figure/} }


% Minimize additional blank pages
\let\cleardoublepage\clearpage % Suppresses new page on odd side
\flushbottom % Avoid vertical blank space between paragraphs

% Title Page
\begin{document}
\selectlanguage{italian}

\begin{titlepage}
\begin{center}
    \begin{figure}
        \includegraphics[width=3.5cm, height=3.5cm]{unisa.png}
        \centering
    \end{figure}
    {\Large Università degli Studi di Salerno}\\[0.2truecm]
    {\large Dipartimento di Informatica\\Corso di Laurea Triennale in Informatica}\\
    \hrulefill
    \vfill
    {\large Progetto Calcolo Probabilità Statistica Matematica\\(CPSM)}\\[0.1truecm]
    \vfill\vfill
    {\LARGE {\bf Indagine Statistica sulle\\[0.1truecm]Morti in incidenti stradali}}
    \vfill\vfill
    
    \hfill  \textbf{Tozza Gennaro Carmine}
    \centerline{\hfill Matricola: 0512120382}
    
    \vfill
    \hrulefill 
    \begin{center} Anno Accademico 2024-2025 \end{center}
\end{center}
\end{titlepage}

% Suppress page break after table of contents
\tableofcontents

\chapter{Introduzione}
\section{Problematica}
Gli \textbf{incidenti stradali} costituiscono una delle principali emergenze 
di sanità pubblica, in quanto responsabili ogni anno di un elevato 
numero di decessi, in particolare tra i giovani, e di gravi conseguenze
 in termini di disabilità temporanee e permanenti, oltre al drammatico impatto umano e psicologico sulle vittime e 
 sulle loro famiglie. 
\noindent

\section{Scopo del progetto}
Il progetto consiste nel realizzare un’indagine statistica \footnote{\url{https://siqual.istat.it/SIQual/visualizza.do?id=7777778&refresh=true&language=IT}}sugli incidenti stradali verificatisi sulla rete stradale del territorio nazionale, tra il 2010 e il 2023 verbalizzati da un'autorità di Polizia o dai Carabinieri, 
avvenuti su una strada aperta alla circolazione pubblica e che hanno causato morti (entro il 30° giorno) con il coinvolgimento 
di almeno un veicolo. \\\\
\noindent
La rilevazione è condotta correntemente dall’Istat, con la compartecipazione dell'ACI e di numerosi Enti pubblici istituzionali, 
è a carattere totale e a cadenza mensile (inserita tra le rilevazioni di interesse pubblico nel Programma Statistico Nazionale - PSN - IST00142). \\\\
\noindent
Per l'analisi dei dati è stato scelto l'ambiente di calcolo statistico \textbf{R}. \\
R fornisce un'ampia varietà di tecniche statistiche (modellazione lineare e non lineare, test statistici classici, analisi delle serie temporali, classificazione, \dots)
e grafiche ed è altamente estensibile.\\\\
\noindent
Uno dei punti di forza di R è la facilità con cui possono essere prodotti grafici ben progettati e di qualità per la pubblicazione, 
compresi simboli matematici e formule se necessario.\\\\
\noindent
Per semplificare l'analisi, si è scelto di lavorare non sull'intero dataset, 
ma su un sottoinsieme filtrato di dati, relativo alle morti per incidenti stradali che riguardano solo i conducenti di età compresa tra i 21 e i 24 anni.\\\\
\noindent
Per approfondire l'analisi con dati dettagliati e specifici, è possibile consultare il dataset direttamente sul sito dell'ISTAT al seguente link:
\url{https://esploradati.istat.it/databrowser/#/it/dw/categories/IT1,Z0810HEA,1.0/HEA_ROAD/IT1,41_270_DF_DCIS_MORTIFERITISTR1_1,1.0}\\\\
\noindent
Il dataset in formato CSV(Comma-Separated Values) è stato ottenuto dalla fonte ISTAT tramite il link indicato, assicurando così l'affidabilità dei dati.\\\\
Il formato scelto (CSV) permette un'agevole manipolazione dei dati, essendo compatibile con la maggior parte dei software statistici e
dei fogli di calcolo, ottimizzando l'analisi e la visualizzazione delle informazioni.\\

\begin{table}[!ht]
\centering
\footnotesize
\begin{tabularx}{\textwidth}{|l|*{14}{>{\centering\arraybackslash}X|}}
\hline
\textbf{Intersezione} & \textbf{'10} & \textbf{'11} & \textbf{'12} & \textbf{'13} & \textbf{'14} & \textbf{'15} & \textbf{'16} & \textbf{'17} & \textbf{'18} & \textbf{'19} & \textbf{'20} & \textbf{'21} & \textbf{'22} & \textbf{'23} \\ 
\hline
Incrocio & 55 & 45 & 42 & 23 & 34 & 24 & 28 & 25 & 23 & 13 & 15 & 16 & 21 & 10 \\ \hline
Rotatoria & 7 & 4 & 2 & 5 & 5 & 1 & 5 & 3 & 1 & 2 & 1 & 2 & -- & 3 \\ \hline
Rettilineo & 92 & 102 & 89 & 82 & 96 & 95 & 66 & 70 & 60 & 72 & 66 & 69 & 69 & 74 \\ \hline
Curva & 58 & 51 & 48 & 46 & 45 & 44 & 41 & 36 & 38 & 42 & 23 & 40 & 27 & 38 \\ \hline
Dosso/Pend. & 2 & 7 & 2 & 4 & 2 & 3 & 5 & 1 & 2 & 3 & 2 & 4 & 3 & 1 \\ \hline
Galleria & 1 & 1 & 1 & 1 & -- & 1 & 1 & 1 & -- & -- & 3 & 1 & -- & -- \\ \hline
\hline
\textbf{Totale} & 215 & 210 & 184 & 161 & 182 & 168 & 146 & 136 & 124 & 132 & 110 & 132 & 120 & 126 \\ \hline
\end{tabularx}
\end{table}

\normalsize


\chapter{Tabelle delle frequenze}

\begin{center}
\begin{lstlisting}[breaklines=true]
# inclusione librerie
library("tidyverse")
require("tidyverse")
library("dplyr")

# viene caricato il dataset
dati <- read.csv("dati_istat.csv")

# filtraggio dati
dati <- dati %>% select(Intersezione, TIME_PERIOD, Osservazione) 
dati <- dati %>% 
  filter(Intersezione != "Totale") 

# 1. Frequenze assolute per intersezione dell'incidente
freq_assolute <- aggregate(Osservazione ~ Intersezione, data=dati, sum)
colnames(freq_assolute) <- c("Intersezione", "Frequenza_Assoluta")
print(freq_assolute)

# 2. Frequenze relative per intersezione dell'incidente
totale <- sum(freq_assolute$Frequenza_Assoluta)
freq_assolute$Frequenza_Relativa <- freq_assolute$Frequenza_Assoluta / totale
print(freq_assolute)

# 3. Frequenze cumulate assolute
freq_assolute <- freq_assolute[order(-freq_assolute$Frequenza_Assoluta),]
freq_assolute$Frequenza_Cumulata_Assoluta <- cumsum(freq_assolute$Frequenza_Assoluta)
print(freq_assolute)

# 4. Frequenze cumulate relative
freq_assolute$Frequenza_Cumulata_Relativa <- freq_assolute$Frequenza_Cumulata_Assoluta / totale
print(freq_assolute)
\end{lstlisting}  
\end{center}

\noindent
L'output generato dal codice R riportato è sintetizzato
 nella seguente tabella:

\begin{table}[!ht]
\centering
\footnotesize
\begin{tabularx}{\textwidth}{|l|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|}
\hline
\textbf{Tipo intersezione} & \textbf{Freq. Assoluta} & \textbf{Freq. Relativa} & \textbf{Freq. Cum. Assoluta} & \textbf{Freq. Cum. Relativa} \\ 
\hline
Rettilineo & 1102 & 0.5135 & 1102 & 0.5135 \\ \hline
Curva & 577 & 0.2689 & 1679 & 0.7824 \\ \hline
Incrocio & 374 & 0.1743 & 2053 & 0.9567 \\ \hline
Dosso/Pendenza/Strettoia & 41 & 0.0191 & 2094 & 0.9758 \\ \hline
Rotatoria & 41 & 0.0191 & 2135 & 0.9949 \\ \hline
Galleria & 11 & 0.0051 & 2146 & 1.0000 \\ \hline
\end{tabularx}
\end{table}
\normalsize

\chapter{Rappresentazione dei dati mediante grafici}
\begin{center}
\begin{lstlisting}[breaklines=true]
# 1. Grafico frequenza assolute
barplot(freq_assolute$Frequenza_Assoluta, 
        names.arg = freq_assolute$Intersezione,
        main = "Frequenze assolute per intersezione",
        xlab = "",
        ylab = "",
        col = "steelblue",
        las = 2) # Etichette verticali
\end{lstlisting}  
\end{center}

\begin{figure}[H] % H forza la posizione esatta
    \centering
    \includegraphics[width=12cm, height=7cm]{Rplot.png} % Adatta l'immagine alla larghezza del testo
\end{figure}

\begin{center}
\begin{lstlisting}[breaklines=true]
# 2. Grafico frequenze relative
barplot(freq_assolute$Frequenza_Relativa, 
        names.arg = freq_assolute$Intersezione,
        main = "Frequenze Relative per Intersezione",
        xlab = "",
        ylab = "",
        col = "coral",
        las = 2,
        cex.names = 0.8)
\end{lstlisting}  
\end{center}

\begin{figure}[H] % H forza la posizione esatta
    \centering
    \includegraphics[width=12cm, height=7cm]{Rplot03.png} % Adatta l'immagine alla larghezza del testo
\end{figure}

\begin{center}
\begin{lstlisting}[breaklines=true]
# 3. Grafico frequenze cumulate assolute
barplot(freq_assolute$Frequenza_Cumulata_Assoluta, 
        names.arg = freq_assolute$Intersezione,
        main = "Frequenze Cumulate Assolute",
        xlab = "",
        ylab = "",
        col = "darkgreen",
        las = 2,
        cex.names = 0.8)
\end{lstlisting}  
\end{center}

\begin{figure}[H] % H forza la posizione esatta
    \centering
    \includegraphics[width=12cm, height=7cm]{Rplot04.png} % Adatta l'immagine alla larghezza del testo
\end{figure}

\begin{center}
\begin{lstlisting}[breaklines=true]
# 4. Grafico frequenze cumulate relative
barplot(freq_assolute$Frequenza_Cumulata_Relativa, 
        names.arg = freq_assolute$Intersezione,
        main = "Frequenze Cumulate Relative",
        xlab = "",
        ylab = "",
        col = "purple",
        las = 2,
        cex.names = 0.8)
\end{lstlisting}  
\end{center}

\begin{figure}[H] % H forza la posizione esatta
    \centering
    \includegraphics[width=12cm, height=7cm]{Rplot05.png} % Adatta l'immagine alla larghezza del testo
\end{figure}


\begin{center}
\begin{lstlisting}[breaklines=true]
# Converti TIME_PERIOD in fattore per mantenere l'ordine originale
dati$TIME_PERIOD <- factor(dati$TIME_PERIOD, levels = unique(dati$TIME_PERIOD))

# Calcola il numero totale di morti per anno
morti_per_anno <- dati %>%
  group_by(TIME_PERIOD) %>%
  summarise(Totale_Morti = sum(Osservazione, na.rm = TRUE))

# Crea il grafico a linee con tutti gli anni visibili
ggplot(morti_per_anno, aes(x = TIME_PERIOD, y = Totale_Morti, group = 1)) +
  geom_line(color = "steelblue", size = 1) +
  geom_point(color = "steelblue", size = 2) +
  labs(title = "Andamento del numero di morti per incidenti stradali",
       x = "Anno",
       y = "Numero di morti") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +  # Riduci dimensione testo
  scale_x_discrete(breaks = levels(morti_per_anno$TIME_PERIOD))  # Mostra tutti i valori
\end{lstlisting}  
\end{center}

\begin{figure}[H] % H forza la posizione esatta
    \centering
    \includegraphics[width=12cm, height=7cm]{Rplot01.png} % Adatta l'immagine alla larghezza del testo
\end{figure}

\begin{center}
\begin{lstlisting}[breaklines=true]
# Crea il grafico a torta
ggplot(freq_assolute, aes(x = "", y = Frequenza_Assoluta, fill = Intersezione)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start = 0) +
  labs(title = "",
       fill = "Tipo di intersezione") +
  theme_void() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
        legend.position = "right") +
  geom_text(aes(label = paste0(round(Frequenza_Assoluta/sum(Frequenza_Assoluta)*100, 1), "%")), 
            position = position_stack(vjust = 0.5),
            size = 3)
\end{lstlisting}  
\end{center}

\begin{figure}[H] % H forza la posizione esatta
    \centering
    \includegraphics[width=13cm, height=8cm]{Rplot08.png} % Adatta l'immagine alla larghezza del testo
\end{figure}



\chapter{Indici di posizione}
In questo capitolo verranno calcolati gli indici di posizione 
sulla variabile numerica \texttt{Osservazione} del dataset 
\texttt{dati}. \\\\
\noindent
Questa variabile rappresenta il numero di morti
 registrato per una specifica combinazione di tipo di intersezione 
 e anno, limitatamente alla fascia di età dei conducenti tra 21 e 24 
 anni. \\\\
 \noindent
 Gli indici di posizione(o di tendenza generale) sono misure che consentono di 
 sintetizzare i dati osservati con un solo valore numerico che sia rappresentativo dei dati stessi.
 Gli indici di posizone più adoperati sono tre
\begin{itemize}
  \item media
  \item mediana
  \item moda
\end{itemize}

\section{Media campionaria}
La media campionaria è la somma di tutte le osservazioni divisa per il numero di osservazioni.
 Fornisce una misura del valore centrale della distribuzione.
\begin{center}
\begin{lstlisting}[breaklines=true]
media_generale <- mean(dati$Osservazione, na.rm = TRUE)
print(paste("Media campionaria generale delle osservazioni:", round(media_generale, 2)))
\end{lstlisting}  
\end{center}
\noindent
Output: 
\begin{verbatim}
"Media campionaria generale delle osservazioni: 27.51"
\end{verbatim}
Questo valore indica che, in media, per ogni specifica combinazione di tipo di intersezione e anno considerata nel dataset filtrato, si sono registrati circa 27.51 decessi.

\section{Mediana campionaria}
La mediana è un numero che precede tanti dati quanti ne segue, ossia il 
valore centrale dei dati riordinati in senso crescente.
\begin{center}
\begin{lstlisting}[breaklines=true]
mediana_generale <- median(dati$Osservazione, na.rm = TRUE)
print(paste("Mediana generale delle osservazioni:", mediana_generale))
\end{lstlisting}  
\end{center}
\noindent
Output:
\begin{verbatim}
"Mediana generale delle osservazioni: 15.5"
\end{verbatim}
 Il fatto che la mediana (15.5)
 sia inferiore alla media (27.51) suggerisce una distribuzione 
 asimmetrica a destra.


\section{Moda campionaria}
La moda è il valore (o i valori, in caso di distribuzioni multimodali)
 che appare più frequentemente in un insieme di dati.
\begin{center}
\begin{lstlisting}[breaklines=true]
find_mode <- function(x) {
    u <- unique(x)
    tab <- tabulate(match(x, u))
    u[tab == max(tab)]
  }

find_mode(dati)
\end{lstlisting}  
\end{center}
\noindent
Output: 
\begin{table}[!ht]
\centering
\footnotesize
%\begin{minipage}{\textwidth}
\centering
\begin{tabular}{|l|c|c|c|c|c|c|}
\hline
\textbf{Tipo} & \multicolumn{6}{c|}{\textbf{Anno}} \\ \cline{2-7}
\textbf{Intersezione} & 2010 & 2011 & 2012 & 2013 & 2014 & 2015 \\ \hline
Incrocio & 55 & 45 & 42 & 23 & 34 & 24 \\ \hline
Rotatoria & 7 & 4 & 2 & 5 & 5 & 1 \\ \hline
Rettilineo & 92 & 102 & 89 & 82 & 96 & 95 \\ \hline
Curva & 58 & 51 & 48 & 46 & 45 & 44 \\ \hline
Dosso/Pend./Str. & 2 & 7 & 2 & 4 & 2 & 3 \\ \hline
Galleria & 1 & 1 & 1 & 1 & - & 1 \\ \hline
\end{tabular}

\vspace{0.5cm}

\begin{tabular}{|l|c|c|c|c|c|c|c|}
\hline
\textbf{Tipo} & \multicolumn{7}{c|}{\textbf{Anno}} \\ \cline{2-8}
\textbf{Intersezione} & 2016 & 2017 & 2018 & 2019 & 2020 & 2021 & 2022-23 \\ \hline
Incrocio & 28 & 25 & 23 & 13 & 15 & 16 & 31 \\ \hline
Rotatoria & 5 & 3 & 1 & 2 & 1 & 2 & 3 \\ \hline
Rettilineo & 66 & 70 & 60 & 72 & 66 & 69 & 143 \\ \hline
Curva & 41 & 36 & 38 & 42 & 23 & 40 & 65 \\ \hline
Dosso/Pend./Str. & 5 & 1 & 2 & 3 & 2 & 4 & 4 \\ \hline
Galleria & 1 & 1 & - & - & 3 & 1 & - \\ \hline
\end{tabular}
%\end{minipage}
\end{table}
\normalsize


\chapter{Indici di variabilità} 
Di seguito calcoliamo gli indici di variabilità(o di dispersione), che descrivono la 
variabilità dei dati osservati e consentono di valutare l'informazione 
fornita dall'indice di posizione utilizzato, dando dei dati più accurati.

\section{Varianza campionaria}
La varianza campionaria ($s^2$) misura la dispersione
 media quadratica dei dati attorno alla media campionaria.
  È espressa nell'unità di misura dei dati al quadrato.
\begin{center}
\begin{lstlisting}[breaklines=true]
# Calcolo della varianza sulla variabile 'Osservazione'.
varianza_campionaria <- var(dati$Osservazione, na.rm = TRUE)
print(paste("Varianza campionaria delle osservazioni:", round(varianza_campionaria, 2)))
\end{lstlisting}
\end{center}
\noindent
Output (valore basato sulla media e mediana fornite, è una stima):
\begin{verbatim}
"Varianza campionaria delle osservazioni: 859.52" 
\end{verbatim}
Un valore elevato della varianza indica una notevole
 dispersione dei dati attorno alla media.
    
\section{Deviazione standard campionaria}
La deviazione standard campionaria ($s$) è la radice quadrata 
della varianza campionaria. Fornisce una misura della dispersione
 media dei dati attorno alla media, espressa nella stessa unità 
 di misura dei dati originali, rendendola più interpretabile 
 della varianza.
\begin{center}
\begin{lstlisting}[breaklines=true]
# Calcolo della deviazione standard sulla variabile 'Osservazione'.
dev_std_campionaria <- sd(dati$Osservazione, na.rm = TRUE)
print(paste("Deviazione standard campionaria delle osservazioni:", round(dev_std_campionaria, 2)))
\end{lstlisting}
\end{center}
\noindent
Output (radice quadrata della varianza stimata):
\begin{verbatim}
"Deviazione standard campionaria delle osservazioni: 29.61"
\end{verbatim}
Questo valore indica che, mediamente, i singoli conteggi di 
decessi si discostano dalla media campionaria (27.51) di 
circa 29.61 unità.
    
\section{Scarto medio assoluto}
Lo scarto medio assoluto (Mean Absolute Deviation, MAD)
 dalla media è la media delle deviazioni assolute (cioè, senza segno)
  dei dati dalla loro media. Come la deviazione standard, 
  misura la dispersione media, ma è meno sensibile ai valori 
  anomali perché non eleva al quadrato gli scarti.
\begin{center}
\begin{lstlisting}[breaklines=true]
# Calcolo dello scarto medio assoluto dalla media per 'Osservazione'.
media_oss <- mean(dati$Osservazione, na.rm = TRUE)
scarto_medio_assoluto <- mean(abs(dati$Osservazione - media_oss), na.rm = TRUE)
print(paste("Scarto medio assoluto (dalla media) delle osservazioni:", round(scarto_medio_assoluto, 2)))
\end{lstlisting}
\end{center}
\noindent
Output (stima):
\begin{verbatim}
"Scarto medio assoluto (dalla media) delle osservazioni: 25.13"
\end{verbatim}
In media, le osservazioni si discostano (in valore assoluto) 
dalla media di circa 25.13 decessi.

\section{Ampiezza del campo di variazione}
L'ampiezza del campo di variazione (o semplicemente "range") 
è la differenza tra il valore massimo e il valore minimo osservato 
nel dataset. È una misura di variabilità semplice ma molto sensibile 
ai valori estremi.
\begin{center}
\begin{lstlisting}[breaklines=true]
# Calcolo del minimo, massimo e ampiezza del campo di variazione per 'Osservazione'.
min_oss <- min(dati$Osservazione, na.rm = TRUE)
max_oss <- max(dati$Osservazione, na.rm = TRUE)
ampiezza_variazione <- max_oss - min_oss 

print(paste("Valore minimo delle osservazioni:", min_oss))
print(paste("Valore massimo delle osservazioni:", max_oss))
print(paste("Ampiezza del campo di variazione delle osservazioni:", ampiezza_variazione))
\end{lstlisting}
\end{center}
\noindent
Output:
\begin{verbatim}
"Valore minimo delle osservazioni: 1" 
"Valore massimo delle osservazioni: 102" 
"Ampiezza del campo di variazione delle osservazioni: 101"
\end{verbatim}


\section{Coefficiente di variazione}
Il coefficiente di variazione (CV) è una misura di variabilità relativa,
 data dal rapporto tra la deviazione standard e la media (in valore assoluto).
\begin{center}
\begin{lstlisting}[breaklines=true]
# Calcolo del coefficiente di variazione per 'Osservazione'.
media_oss <- mean(dati$Osservazione, na.rm = TRUE)
dev_std_oss <- sd(dati$Osservazione, na.rm = TRUE)
coeff_variazione <- (dev_std_oss / abs(media_oss)) * 100 # abs() per media se potesse essere negativa
print(paste("Coefficiente di variazione delle osservazioni:", round(coeff_variazione, 2), "%"))
\end{lstlisting}
\end{center}
\noindent
Output(in percentuale):
\begin{verbatim}
"Coefficiente di variazione delle osservazioni: 107.6 %"
\end{verbatim}
Un CV del 107.6\% indica una variabilità molto elevata rispetto alla 
media. Questo è coerente con il fatto che la deviazione standard (29.61)
 è addirittura leggermente superiore alla media (27.51), suggerendo una
  notevole eterogeneità nei conteggi dei decessi.
\FloatBarrier


\chapter{Indici di forma}
Gli indici di forma misurano caratteristiche relative alla forma della distribuzione
dati. I più usati sono l'indice di asimmetria e l'indice di curtosi.

\section{Indice di asimmetria}
L'indice di asimmetria (skewness) misura il grado di simmetria di
 una distribuzione di dati attorno alla sua media.
\begin{itemize}
    \item Un valore di \textbf{skewness $>$ 0} indica un'asimmetria positiva (coda a destra): la distribuzione ha una coda che si estende maggiormente verso i valori più alti. La media è tipicamente maggiore della mediana.
    \item Un valore di \textbf{skewness $<$ 0} indica un'asimmetria negativa (coda a sinistra): la distribuzione ha una coda che si estende maggiormente verso i valori più bassi. La media è tipicamente minore della mediana.
    \item Un valore di \textbf{skewness $\approx$ 0} indica una distribuzione approssimativamente simmetrica (come la distribuzione normale).
\end{itemize}

\begin{center}
\begin{lstlisting}[breaklines=true]
# Calcolo dell'indice di asimmetria per 'Osservazione'.
indice_asimmetria <- skewness(dati$Osservazione, na.rm = TRUE)
print(paste("Indice di asimmetria (Skewness) delle osservazioni:", round(indice_asimmetria, 2)))
\end{lstlisting}
\end{center}
\noindent
Output:
\begin{verbatim}
"Indice di asimmetria (Skewness) delle osservazioni: 0.9"
\end{verbatim}
Un valore di 0.9 indica una moderata asimmetria positiva
 (coda a destra). Questo è coerente con l'osservazione precedente
  che la media (27.51) è maggiore della mediana (15.5), suggerendo 
  che ci sono alcune osservazioni con un numero di decessi relativamente
   alto che "stirano" la coda destra della distribuzione.\\

\noindent
Per visualizzare graficamente questa asimmetria, 
possiamo generare un istogramma con una curva di densità 
sovrapposta e linee verticali per la media e la mediana.

\begin{center}
\begin{lstlisting}[breaklines=true]
# Creazione del grafico
skewness_plot <- ggplot(dati, aes(x = Osservazione)) +
  geom_histogram(aes(y = ..density..), binwidth = 5, fill = "lightblue", color = "black", alpha = 0.7) +
  geom_density(color = "darkblue", linewidth = 1) +
  geom_vline(aes(xintercept = media_oss, color = "Media"), linetype = "dashed", linewidth = 1) +
  geom_vline(aes(xintercept = mediana_generale, color = "Mediana"), linetype = "dotted", linewidth = 1) +
  labs(title = "Distribuzione del Numero di Osservazioni (Decessi)",
       subtitle = paste0("Skewness: ", round(indice_asimmetria, 2), 
                         " | Media: ", round(media_oss, 2), 
                         " | Mediana: ", round(mediana_generale, 2)),
       x = "Numero di Osservazioni (Decessi)",
       y = "Densita") +
  scale_color_manual(name = "Statistiche", values = c("Media" = "red", "Mediana" = "green")) +
  theme_minimal()

print(skewness_plot)
\end{lstlisting}
\end{center}

\begin{figure}[H] 
    \centering
    \includegraphics[width=12cm, height=7cm]{Rplot06.png} 
\end{figure}

\section{Indice di curtosi} 
L'indice di curtosi misura l'appiattimento di
 una distribuzione, in particolare la concentrazione dei dati attorno
  al valore centrale e la "pesantezza" delle code, rispetto a una 
  distribuzione normale.
\begin{itemize}
    \item \textbf{Eccesso di curtosi $>$ 0} (Curtosi $>$ 3): Distribuzione leptocurtica. È più appuntita al centro e ha code più pesanti (maggior probabilità di valori estremi) rispetto a una normale.
    \item \textbf{Eccesso di curtosi $<$ 0} (Curtosi $<$ 3): Distribuzione platicurtica. È più piatta al centro e ha code più leggere rispetto a una normale.
    \item \textbf{Eccesso di curtosi $\approx$ 0} (Curtosi $\approx$ 3): Distribuzione normocurtica. Ha una forma simile a quella di una distribuzione normale in termini di appiattimento.
\end{itemize}

\begin{center}
\begin{lstlisting}[breaklines=true]
# Calcolo dell'indice di curtosi (eccesso di curtosi) per 'Osservazione'.
indice_curtosi <- kurtosis(dati$Osservazione, na.rm = TRUE)
print(paste("Indice di curtosi (eccesso di curtosi) delle osservazioni:", round(indice_curtosi, 2)))
# La curtosi "classica" sarebbe approssimativamente: round(indice_curtosi, 2) + 3
\end{lstlisting}
\end{center}
\noindent
Output:
\begin{verbatim}
"Indice di curtosi (eccesso di curtosi) delle osservazioni: 2.64" 
\end{verbatim}
Un eccesso di curtosi di circa 2.64 (corrispondente a una curtosi
 "classica" di circa 2.64 + 3 = 5.64) indica una distribuzione 
 marcatamente leptocurtica.\\\\
 \noindent
  Questo significa che la distribuzione 
 del numero di decessi per combinazione intersezione/anno presenta
  un picco più pronunciato attorno alla moda/mediana e code più 
  "pesanti" rispetto a una distribuzione normale. \\\\
  \noindent
  Ciò implica una 
  maggiore frequenza di valori vicini al centro, ma anche una
   maggiore probabilità di osservare valori estremi (molto alti,
    data l'asimmetria positiva) rispetto a quanto ci si aspetterebbe 
    da una distribuzione normale.\\

\noindent
Graficamente si ha
\begin{center}
\begin{lstlisting}[breaklines=true]
# Creazione del grafico per la curtosi
kurtosis_plot <- ggplot(dati, aes(x = Osservazione)) +
  geom_histogram(aes(y = ..density..), binwidth = 5, fill = "lightcoral", color = "black", alpha = 0.7) +
  geom_density(color = "darkred", linewidth = 1) +
  geom_vline(aes(xintercept = media_oss, color = "Media"), linetype = "dashed", linewidth = 1) +
  labs(title = "Distribuzione del Numero di Osservazioni (Decessi)",
       subtitle = paste0("Eccesso di Curtosi: ", round(indice_curtosi, 2),
                         " | Media: ", round(media_oss, 2)),
       x = "Numero di Osservazioni (Decessi)",
       y = "Densita") +
  scale_color_manual(name = "Statistiche", values = c("Media" = "blue")) +
  theme_minimal()

print(kurtosis_plot)

\end{lstlisting}
\end{center}


\begin{figure}[H] 
    \centering
    \includegraphics[width=12cm, height=7cm]{Rplot07.png} 
\end{figure}


\end{document}